---
title: Javascript作用域链详解
date: 2017-09-30 15:41:32
categories: "前端"
tags:
     - javascript
description:
---

> 学习的时候碰到了作用域链，但是书上用了大块文字说明作用域链的机制，所以我写一篇文章，以梳理作用域链的知识。
<!--more-->

## 作用域链的变量解析

每一段Javascript（全局代码或函数）都有一个与之关联的作用域链（scope chain）。
*scope n. 范围；余地；视野；眼界；导弹射程 vt. 审视*

这个作用域链是一个对象列表或者链表，这组对象定义了这段代码“作用域中”的变量。

当Javascript需要查找变量x的值的时候（这个过程称作**“变量解析”**），它会从链的第一个对象开始查找，如果这个对象有一个名为x的属性，则会直接使用这个属性的值。

如果没有一个对象拥有属性x，则会抛出一个错误。
```
  对象A => 对象B => 对象C
——————————————————————————>
        作用域链
```

## 作用域链的更新
### 不嵌套时作用域链
在不包括嵌套的函数体内，作用域链上有两个对象，第一个是定义函数参数和局部变量的对象，第二个是全局对象。
```
// 对于一个不嵌套的函数
function f(x) {}
// 作用域链为
对象A {
    函数参数x：
    局部变量：
}
      ↓
全局对象window { }  
```

### 作用域链创建规则
**当调用这个函f(x)时，它创建一个新的对象来存储它的局部变量**，并将这个对象添加至保存的那个作用域链上，同时创建一个新的更长的表示函数调用作用域的“链”。

对于嵌套函数，事情更加有趣。

**每次调用外部函数时，内部函数都会重新定义一次**。因为每次调用外部函数的时候，作用域链都是不同的。

内部函数在每次定义的时候都有微妙查表——在每次调用外部函数的时候，内部函数的代码都是相同的，而且关联这段代码的作用域链也不想他。
